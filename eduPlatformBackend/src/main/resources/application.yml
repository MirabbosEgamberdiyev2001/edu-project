spring:
  application:
    name: eduplatform
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev}

  datasource:
    url: ${DATABASE_URL:jdbc:postgresql://localhost:5432/eduplatform}
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:1234}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      idle-timeout: 300000
      connection-timeout: 20000

  jpa:
    hibernate:
      ddl-auto: ${JPA_DDL_AUTO:create-drop}
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
    open-in-view: false

  flyway:
    enabled: ${FLYWAY_ENABLED:true}
    baseline-on-migrate: true
    baseline-version: 0
    locations: classpath:db/migration
    out-of-order: true

  jackson:
    default-property-inclusion: non_null
    serialization:
      write-dates-as-timestamps: false
  # Mail Configuration
  mail:
    host: ${MAIL_HOST:smtp.mail.ru}
    port: ${MAIL_PORT:465}
    username: ${MAIL_USERNAME:}
    password: ${MAIL_PASSWORD:}
    default-encoding: UTF-8
    properties:
      mail:
        smtp:
          auth: true
          ssl:
            enable: true
          starttls:
            enable: false
          socketFactory:
            port: 465
            class: javax.net.ssl.SSLSocketFactory
        transport:
          protocol: smtps
    test-connection: false

  servlet:
    multipart:
      max-file-size: 5MB
      max-request-size: 10MB

  mvc:
    async:
      request-timeout: 120000

  lifecycle:
    timeout-per-shutdown-phase: 30s

server:
  port: ${SERVER_PORT:8082}
  servlet:
    context-path: /
  shutdown: graceful

jwt:
  secret: ${JWT_SECRET:your_jwt_secret_here_at_least_256_bits_long}
  access-expiration: ${JWT_ACCESS_EXPIRATION:900000}
  refresh-expiration: ${JWT_REFRESH_EXPIRATION:604800000}

springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    operations-sorter: method

app:
  frontend:
    base-url: ${FRONTEND_BASE_URL:http://localhost:5173}
  cors:
    allowed-origins: ${CORS_ORIGINS:http://localhost:3000,http://localhost:5173,http://localhost:5174}
  mail:
    from: ${MAIL_FROM:}
    enabled: ${MAIL_ENABLED:true}
  storage:
    upload-dir: ${UPLOAD_DIR:./uploads}
  eskiz:
    enabled: ${ESKIZ_ENABLED:false}
    base-url: ${ESKIZ_BASE_URL:https://notify.eskiz.uz}
    email: ${ESKIZ_EMAIL:}
    password: ${ESKIZ_PASSWORD:}
    sender: ${ESKIZ_SENDER:4546}
  payment:
    test-mode: ${PAYMENT_TEST_MODE:false}
    payme:
      enabled: ${PAYME_ENABLED:false}
      merchant-id: ${PAYME_MERCHANT_ID:}
      merchant-key: ${PAYME_MERCHANT_KEY:}
      checkout-url: ${PAYME_CHECKOUT_URL:https://checkout.paycom.uz}
      test-checkout-url: ${PAYME_TEST_CHECKOUT_URL:https://checkout.test.paycom.uz}
      transaction-timeout: ${PAYME_TRANSACTION_TIMEOUT:43200000}
    click:
      enabled: ${CLICK_ENABLED:false}
      merchant-id: ${CLICK_MERCHANT_ID:}
      service-id: ${CLICK_SERVICE_ID:}
      secret-key: ${CLICK_SECRET_KEY:}
      merchant-user-id: ${CLICK_MERCHANT_USER_ID:}
    uzum:
      enabled: ${UZUM_ENABLED:false}
      service-id: ${UZUM_SERVICE_ID:}
      secret-key: ${UZUM_SECRET_KEY:}
  google:
    client-id: ${GOOGLE_CLIENT_ID:237372892439-4bju17u6k3cjoil26p148m21ilmecd9s.apps.googleusercontent.com}
  telegram:
    bot-token: ${TELEGRAM_BOT_TOKEN:}
    bot-username: ${TELEGRAM_BOT_USERNAME:}
    auth-data-max-age-seconds: ${TELEGRAM_AUTH_MAX_AGE:86400}

resilience4j:
  ratelimiter:
    instances:
      auth:
        limitForPeriod: 5
        limitRefreshPeriod: 15m
        timeoutDuration: 0
      otp:
        limitForPeriod: 3
        limitRefreshPeriod: 5m
        timeoutDuration: 0
      default:
        limitForPeriod: 100
        limitRefreshPeriod: 1m
        timeoutDuration: 0

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: when_authorized
      show-components: when_authorized
  metrics:
    tags:
      application: eduplatform

logging:
  level:
    uz.eduplatform: ${LOG_LEVEL:INFO}
    org.hibernate.SQL: ${SQL_LOG_LEVEL:WARN}
